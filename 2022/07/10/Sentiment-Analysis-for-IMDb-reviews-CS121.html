<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Title | fastpages</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Title" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An easy to use blogging platform with support for Jupyter Notebooks." />
<meta property="og:description" content="An easy to use blogging platform with support for Jupyter Notebooks." />
<link rel="canonical" href="https://aashitak.github.io/CS121ProjectExample1/2022/07/10/Sentiment-Analysis-for-IMDb-reviews-CS121.html" />
<meta property="og:url" content="https://aashitak.github.io/CS121ProjectExample1/2022/07/10/Sentiment-Analysis-for-IMDb-reviews-CS121.html" />
<meta property="og:site_name" content="fastpages" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-07-10T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Title" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-07-10T00:00:00-05:00","datePublished":"2022-07-10T00:00:00-05:00","description":"An easy to use blogging platform with support for Jupyter Notebooks.","headline":"Title","mainEntityOfPage":{"@type":"WebPage","@id":"https://aashitak.github.io/CS121ProjectExample1/2022/07/10/Sentiment-Analysis-for-IMDb-reviews-CS121.html"},"url":"https://aashitak.github.io/CS121ProjectExample1/2022/07/10/Sentiment-Analysis-for-IMDb-reviews-CS121.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/CS121ProjectExample1/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://aashitak.github.io/CS121ProjectExample1/feed.xml" title="fastpages" /><link rel="shortcut icon" type="image/x-icon" href="/CS121ProjectExample1/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/CS121ProjectExample1/">fastpages</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/CS121ProjectExample1/about/">About Me</a><a class="page-link" href="/CS121ProjectExample1/search/">Search</a><a class="page-link" href="/CS121ProjectExample1/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Title</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-07-10T00:00:00-05:00" itemprop="datePublished">
        Jul 10, 2022
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      10 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/AashitaK/CS121ProjectExample1/tree/master/_notebooks/2022-07-10-Sentiment Analysis for IMDb reviews - CS121.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/CS121ProjectExample1/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/AashitaK/CS121ProjectExample1/master?filepath=_notebooks%2F2022-07-10-Sentiment+Analysis+for+IMDb+reviews+-+CS121.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/CS121ProjectExample1/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/AashitaK/CS121ProjectExample1/blob/master/_notebooks/2022-07-10-Sentiment Analysis for IMDb reviews - CS121.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/CS121ProjectExample1/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2FAashitaK%2FCS121ProjectExample1%2Fblob%2Fmaster%2F_notebooks%2F2022-07-10-Sentiment+Analysis+for+IMDb+reviews+-+CS121.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/CS121ProjectExample1/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-07-10-Sentiment Analysis for IMDb reviews - CS121.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sentiment-Analysis-for-IMDb-reviews">Sentiment Analysis for IMDb reviews<a class="anchor-link" href="#Sentiment-Analysis-for-IMDb-reviews"> </a></h3><p>We will build a classification model to predict whether a movie review from IMDb website is positive or negative using neural networks. We will use the <a href="https://www.kaggle.com/lakshmi25npathi/imdb-dataset-of-50k-movie-reviews">IMDb Dataset of 50K Movie Reviews</a> from <a href="https://en.wikipedia.org/wiki/Kaggle">Kaggle</a> for this purpose.</p>
<p>You can run this notebook on <a href="https://colab.research.google.com/">Google Colab</a>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">seed</span>
<span class="n">seed</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># If you are using Google Colab, run the following to upload the dataset</span>
<span class="c1"># from google.colab import files</span>
<span class="c1"># uploaded = files.upload()</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;IMDB Dataset.csv&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>review</th>
      <th>sentiment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>One of the other reviewers has mentioned that ...</td>
      <td>positive</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A wonderful little production. &lt;br /&gt;&lt;br /&gt;The...</td>
      <td>positive</td>
    </tr>
    <tr>
      <th>2</th>
      <td>I thought this was a wonderful way to spend ti...</td>
      <td>positive</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Basically there's a family where a little boy ...</td>
      <td>negative</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Petter Mattei's "Love in the Time of Money" is...</td>
      <td>positive</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The dataset consists of two columns - review and its sentiment.</p>
<p>Let us check the number of rows and columns in the dataset.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(50000, 2)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are 50,000 movie reviews in total.</p>
<p>Let us check the number of positive and negative reviews in our dataset.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;sentiment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>negative    25000
positive    25000
Name: sentiment, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The dataset is equally divided into positive and negative reviews.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Steps-for-building-a-sentiment-detection-model:">Steps for building a sentiment detection model:<a class="anchor-link" href="#Steps-for-building-a-sentiment-detection-model:"> </a></h3><ul>
<li>Preprocessing text<ul>
<li>Cleaning the text</li>
<li>Splitting the dataset into training and validation sets</li>
<li>Converting the reviews into numerical vectors (vectorization)</li>
</ul>
</li>
<li>Training a neural network for sentiment detection<ul>
<li>Defining the architecture of the neural net</li>
<li>Training on the dataset</li>
<li>Computing accuracy scores on training and validation sets</li>
</ul>
</li>
<li>Testing the model to detect sentiment for new unseen reviews</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us peek into one of the movie review.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">text</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;Petter Mattei\&#39;s &#34;Love in the Time of Money&#34; is a visually stunning film to watch. Mr. Mattei offers us a vivid portrait about human relations. This is a movie that seems to be telling us what money, power and success do to people in the different situations we encounter. &lt;br /&gt;&lt;br /&gt;This being a variation on the Arthur Schnitzler\&#39;s play about the same theme, the director transfers the action to the present time New York where all these different characters meet and connect. Each one is connected in one way, or another to the next person, but no one seems to know the previous point of contact. Stylishly, the film has a sophisticated luxurious look. We are taken to see how these people live and the world they live in their own habitat.&lt;br /&gt;&lt;br /&gt;The only thing one gets out of all these souls in the picture is the different stages of loneliness each one inhabits. A big city is not exactly the best place in which human relations find sincere fulfillment, as one discerns is the case with most of the people we encounter.&lt;br /&gt;&lt;br /&gt;The acting is good under Mr. Mattei\&#39;s direction. Steve Buscemi, Rosario Dawson, Carol Kane, Michael Imperioli, Adrian Grenier, and the rest of the talented cast, make these characters come alive.&lt;br /&gt;&lt;br /&gt;We wish Mr. Mattei good luck and await anxiously for his next work.&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The text contains HTML tags such as <code>&lt;br /&gt;</code> that we will remove using regular expressions.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;&lt;.*?&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">text</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;Petter Mattei\&#39;s &#34;Love in the Time of Money&#34; is a visually stunning film to watch. Mr. Mattei offers us a vivid portrait about human relations. This is a movie that seems to be telling us what money, power and success do to people in the different situations we encounter. This being a variation on the Arthur Schnitzler\&#39;s play about the same theme, the director transfers the action to the present time New York where all these different characters meet and connect. Each one is connected in one way, or another to the next person, but no one seems to know the previous point of contact. Stylishly, the film has a sophisticated luxurious look. We are taken to see how these people live and the world they live in their own habitat.The only thing one gets out of all these souls in the picture is the different stages of loneliness each one inhabits. A big city is not exactly the best place in which human relations find sincere fulfillment, as one discerns is the case with most of the people we encounter.The acting is good under Mr. Mattei\&#39;s direction. Steve Buscemi, Rosario Dawson, Carol Kane, Michael Imperioli, Adrian Grenier, and the rest of the talented cast, make these characters come alive.We wish Mr. Mattei good luck and await anxiously for his next work.&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We define a <code>clean_text</code> function that we will use below while vectorizing the text.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="k">def</span> <span class="nf">clean_text</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&lt;.*?&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span> <span class="c1"># remove HTML tags</span>
    <span class="k">return</span> <span class="n">text</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we extract our input feature <code>X</code> and the target output <code>y</code> from the dataframe <code>df</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;review&#39;</span><span class="p">]</span> 
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;sentiment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;positive&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;negative&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then we split the dataset into train and validation sets.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="c1"># default is 75% / 25% train-test split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Vectorization">Vectorization<a class="anchor-link" href="#Vectorization"> </a></h3><p>Our input <code>X</code> consists of texts, which are sequences of words, spaces, punctuations, emojis, etc. and we need to convert these texts into a numerical vectors. There are multiple ways to vectorize the text and we will use TF-IDF vectorization with Bag-Of-Words (BOW) method.</p>
<p>Bag-Of-Words (BOW) method simply means we count the occurence of words without keeping track of the order of words in a sentence. The steps for vectorizing using TF-IDF are as follows:</p>
<ul>
<li>We first create a vocabulary of words and compute the size of the vocabulary, say $n$.</li>
<li>For $n$-dimensional vector, we assign each index to a specific word in the vocabulary.</li>
<li>Next we iterate through the text samples in the dataset:<ul>
<li>we compute TF-IDF frequency for each word and </li>
<li>we create a vector by assigning the above frequencies in their respective indices and use zeros for the words not present in the sample text. </li>
</ul>
</li>
</ul>
<h4 id="Term-Frequency-Inverse-Document-Frequency-(TF-IDF)">Term Frequency Inverse Document Frequency (TF-IDF)<a class="anchor-link" href="#Term-Frequency-Inverse-Document-Frequency-(TF-IDF)"> </a></h4><p>TF-IDF frequency tweaks the usual frequency so that rarer words are given more weight. Some words such as "wonderful", "disgusting", etc. would be stronger indicators for the sentiment of the reviews than words such as "watching", "become", "every", "after", etc. and hence, it makes sense to use TF-IDF for our project.</p>
<p>
$$ \text{TF-IDF} = \text{TF (Term Frequency)} * \text{IDF (Inverse Document Frequency)} $$
</p>
<p>Term Frequency (TF) is the number of times a word occur in a review. It is multiplied by Inverse Document Frequency (IDF) which is a measure of the originality of the word. The words that are rarer have higher IDF values and hence, they are weighted more in TF-IDF than their true frequency as compared to commonly occuring words.</p>
<p>
$$ \text{Inverse Document Frequency (IDF) for a word} = \log \Bigg( \frac{\text{Total number of reviews}}{\text{Number of reviews that contain this word}}\Bigg)$$
</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>

<span class="n">vectorizer</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">stop_words</span><span class="o">=</span><span class="s2">&quot;english&quot;</span><span class="p">,</span>
                             <span class="n">preprocessor</span><span class="o">=</span><span class="n">clean_text</span><span class="p">,</span> <span class="c1"># clean_text function defined above</span>
                             <span class="n">max_features</span><span class="o">=</span><span class="mi">15000</span><span class="p">)</span>

<span class="n">X_train_vectorized</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>    
<span class="n">X_valid_vectorized</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_valid</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Constructing-a-simple-network">Constructing a simple network<a class="anchor-link" href="#Constructing-a-simple-network"> </a></h3><p>We import the relevant functions from <a href="https://keras.io/">Keras</a> that we plan to use in our network.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="kn">import</span> <span class="n">Embedding</span><span class="p">,</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span>
<span class="kn">from</span> <span class="nn">keras.initializers</span> <span class="kn">import</span> <span class="n">he_normal</span>
<span class="kn">from</span> <span class="nn">keras.callbacks</span> <span class="kn">import</span> <span class="n">ModelCheckpoint</span><span class="p">,</span> <span class="n">EarlyStopping</span>


<span class="n">input_dim</span> <span class="o">=</span> <span class="n">X_train_vectorized</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># size of input variables</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us check the shapes of the training and validation sets.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_valid</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_valid</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((37500,), (12500,), (37500,), (12500,))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us define a simple neural network with a single hidden layer. We use ReLU for the hidden layer and sigmoid activation for the output layer since it is a binary classification problem.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="n">input_dim</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">he_normal</span><span class="p">()))</span> <span class="c1"># Hidden layer</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.4</span><span class="p">))</span> <span class="c1"># Adding dropout regularization to the hidden layer with dropout prob=0.5</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;sigmoid&quot;</span><span class="p">))</span> <span class="c1"># Output layer</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Model: &#34;sequential&#34;
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense (Dense)                (None, 32)                480032    
_________________________________________________________________
dropout (Dropout)            (None, 32)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 33        
=================================================================
Total params: 480,065
Trainable params: 480,065
Non-trainable params: 0
_________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We compile the model by using accuracy as the evaluation metric, ADAM as optimizer and binary cross-entropy loss funtion.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s2">&quot;binary_crossentropy&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we train the model while using <code>EarlyStopping</code> for the training to stop early if the validation loss is not decreasing any further.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">earlystopping</span> <span class="o">=</span> <span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">model_history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_vectorized</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> 
                          <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> 
                          <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_valid_vectorized</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">earlystopping</span><span class="p">);</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/10
147/147 [==============================] - 3s 20ms/step - loss: 0.6252 - accuracy: 0.7680 - val_loss: 0.4148 - val_accuracy: 0.8698
Epoch 2/10
147/147 [==============================] - 1s 8ms/step - loss: 0.3653 - accuracy: 0.8857 - val_loss: 0.3021 - val_accuracy: 0.8879
Epoch 3/10
147/147 [==============================] - 1s 8ms/step - loss: 0.2618 - accuracy: 0.9127 - val_loss: 0.2671 - val_accuracy: 0.8934
Epoch 4/10
147/147 [==============================] - 1s 9ms/step - loss: 0.2166 - accuracy: 0.9257 - val_loss: 0.2540 - val_accuracy: 0.8942
Epoch 5/10
147/147 [==============================] - 1s 10ms/step - loss: 0.1836 - accuracy: 0.9380 - val_loss: 0.2512 - val_accuracy: 0.8941
Epoch 6/10
147/147 [==============================] - 1s 8ms/step - loss: 0.1663 - accuracy: 0.9444 - val_loss: 0.2536 - val_accuracy: 0.8922
Epoch 00006: early stopping
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can plot the loss function values  for training and validation sets over the epochs using <code>model_history</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="k">def</span> <span class="nf">plot_loss</span><span class="p">(</span><span class="n">model_history</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">model_history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">]),</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">model_history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_loss&#39;</span><span class="p">]),</span> <span class="s1">&#39;b&#39;</span> <span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;val&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Epoch&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Loss&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Loss over the epochs&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    
<span class="n">plot_loss</span><span class="p">(</span><span class="n">model_history</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also plot the accuracy values for training and validation sets over the epochs using <code>model_history</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">plot_accuracy</span><span class="p">(</span><span class="n">model_history</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">model_history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]),</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">model_history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_accuracy&#39;</span><span class="p">]),</span> <span class="s1">&#39;b&#39;</span> <span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;val&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Epoch&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Accuracy&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Accuracy over the epochs&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plot_accuracy</span><span class="p">(</span><span class="n">model_history</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us use our trained neural network to predict the sentiment for the movie reviews. Note that the network is giving us the probability that a review is positive, and thus we expect higher probabilities for positive reviews whereas lower probabilities for negative ones.</p>
<p>Let us check with a straightforward positive review.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">review1</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;What a gripping, heart wrenching, hard hitting film...&quot;</span><span class="p">]</span>
<span class="n">vectorized_review1</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">review1</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">vectorized_review1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[0.97009695]], dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The model classified the above review correctly as positive with a high probability. Let us now check for a negative review.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">review2</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;That&#39;s nothing new in this film.&quot;</span><span class="p">]</span>
<span class="n">vectorized_review2</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">review2</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">vectorized_review2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[0.0942305]], dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The model again classified the above negative review correctly by giving a low probability score.</p>
<p>Our model is looking at individual words weighted by TF-IDF frequency but it does not take into account the sequence of the words, and thus missing the context. Let us see how it does with more reviews.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">review2</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;If you can keep both eyes open through its whole three-hour length you&#39;re a better man than I am.&quot;</span><span class="p">]</span>
<span class="n">vectorized_review2</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">review2</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">vectorized_review2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[0.69224685]], dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It is getting the prediction wrong by a long margin, probably because most words are neutral except for better which is usually positive. Let us check with another review where sequence of the words matter a lot to get a sense of the sentiment.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">review2</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;In and of itself it is not a bad film.&quot;</span><span class="p">]</span>
<span class="n">vectorized_review2</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">review2</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">vectorized_review2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[0.00568324]], dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The model got it wrong again. Let us check it with another similar review.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">review3</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;This show was not really funny anymore.&quot;</span><span class="p">]</span>
<span class="n">vectorized_review3</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">review3</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">vectorized_review3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[0.8506278]], dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Same result as above.</p>
<p>Though we are able to achieve an accuracy score of $~90\%$, the above examples illustrates that the neural network architectures that makes use of the sequence of words in a sentiment might be a better fit for this project.</p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/CS121ProjectExample1/2022/07/10/Sentiment-Analysis-for-IMDb-reviews-CS121.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/CS121ProjectExample1/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/CS121ProjectExample1/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/CS121ProjectExample1/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/fastai" target="_blank" title="fastai"><svg class="svg-icon grey"><use xlink:href="/CS121ProjectExample1/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" target="_blank" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/CS121ProjectExample1/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
